"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[8274],{5045:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>a,frontMatter:()=>d,metadata:()=>t,toc:()=>c});var i=s(4848),r=s(8453);const d={},o="Exposome Geocoder \u2013 Input Preparation and Usage Guide",t={id:"GIS-Exposure-Data/GIS-Exposure-Data",title:"Exposome Geocoder \u2013 Input Preparation and Usage Guide",description:"Note: This toolkit does not require or share any Protected Health Information (PHI).",source:"@site/docs/GIS-Exposure-Data/GIS-Exposure-Data.mdx",sourceDirName:"GIS-Exposure-Data",slug:"/GIS-Exposure-Data/",permalink:"/Chorus_SOP/docs/GIS-Exposure-Data/",draft:!1,unlisted:!1,editUrl:"https://github.com/chorus-ai/Chorus_SOP/edit/review/sop-website/docs/GIS-Exposure-Data/GIS-Exposure-Data.mdx",tags:[],version:"current",lastUpdatedBy:"Polina Talapova",lastUpdatedAt:1770295983,formattedLastUpdatedAt:"Feb 5, 2026",frontMatter:{},sidebar:"sopSidebar",previous:{title:"GIS Exposure Data",permalink:"/Chorus_SOP/docs/category/gis-exposure-data"},next:{title:"Imaging Data",permalink:"/Chorus_SOP/docs/category/imaging-data"}},l={},c=[{value:"\ud83d\udcd1 Table of Contents",id:"-table-of-contents",level:2},{value:"Overview",id:"overview",level:2},{value:"Input Options",id:"input-options",level:2},{value:"Option 1: Address",id:"option-1-address",level:3},{value:"Optional Supporting Files",id:"optional-supporting-files",level:4},{value:"LOCATION.csv (Follows CDM format)",id:"locationcsv-follows-cdm-format",level:5},{value:"LOCATION_HISTORY.csv (Follows CDM format)",id:"location_historycsv-follows-cdm-format",level:5},{value:"Option 2: Coordinates",id:"option-2-coordinates",level:3},{value:"Option 3: OMOP CDM",id:"option-3-omop-cdm",level:3},{value:"Usage Guide",id:"usage-guide",level:2},{value:"Step 1: Prepare Input Data",id:"step-1-prepare-input-data",level:3},{value:"Folder Structure",id:"folder-structure",level:4},{value:"Step 2: Generate FIPS Codes",id:"step-2-generate-fips-codes",level:3},{value:"For CSV Input (Option 1 &amp; 2)",id:"for-csv-input-option-1--2",level:4},{value:"For macOS / Linux / Ubuntu",id:"for-macos--linux--ubuntu",level:5},{value:"For Windows",id:"for-windows",level:5},{value:"For OMOP Input (Option 3)",id:"for-omop-input-option-3",level:4},{value:"Step 3: Output Structure",id:"step-3-output-structure",level:3},{value:"CSV Input (Option 1 &amp; 2)",id:"csv-input-option-1--2",level:4},{value:"<strong>Output Folder Example</strong>",id:"output-folder-example",level:4},{value:"Reason Column Values",id:"reason-column-values",level:5},{value:"OMOP Input (Option 3)",id:"omop-input-option-3",level:4},{value:"<strong>Folder Structure</strong>",id:"folder-structure-1",level:4},{value:"Step 4: GIS Linkage with PostGIS-Exposure Tool",id:"step-4-gis-linkage-with-postgis-exposure-tool",level:3},{value:"Prerequisites for GIS Linkage",id:"prerequisites-for-gis-linkage",level:4},{value:"Expected Outputs",id:"expected-outputs",level:4},{value:"GIS Linkage Workflow",id:"gis-linkage-workflow",level:4},{value:"Notes &amp; Tips",id:"notes--tips",level:4},{value:"Step 5: Validate &amp; Inspect Outputs",id:"step-5-validate--inspect-outputs",level:3},{value:"Step 6: Optional - Site-level Date Shifting",id:"step-6-optional---site-level-date-shifting",level:3},{value:"Step 7: Upload &amp; Centralized De-identification",id:"step-7-upload--centralized-de-identification",level:3},{value:"References &amp; sample files",id:"references--sample-files",level:3},{value:"Geocoding",id:"geocoding",level:4},{value:"GIS Linkage",id:"gis-linkage",level:4},{value:"Related Office Hours",id:"related-office-hours",level:2},{value:"Appendix",id:"appendix",level:2},{value:"Geocoding Workflow",id:"geocoding-workflow",level:3},{value:"Method: DeGAUSS Toolkit (Docker-based)",id:"method-degauss-toolkit-docker-based",level:4},{value:"DeGAUSS Docker Commands (Executed Internally)",id:"degauss-docker-commands-executed-internally",level:4},{value:"Script Highlights",id:"script-highlights",level:4},{value:"Address_to_FIPS.py Logic",id:"address_to_fipspy-logic",level:5},{value:"OMOP_to_FIPS.py Logic",id:"omop_to_fipspy-logic",level:5}];function h(e){const n={a:"a",blockquote:"blockquote",br:"br",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"exposome-geocoder--input-preparation-and-usage-guide",children:"Exposome Geocoder \u2013 Input Preparation and Usage Guide"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Note:"})," This toolkit does ",(0,i.jsx)(n.strong,{children:"not"})," require or share any Protected Health Information (PHI)."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["This repository provides a ",(0,i.jsx)(n.strong,{children:"reproducible workflow"})," to geocode patient location data and link the resulting Census Tract (FIPS 11-digit) identifiers with Exposome datasets for environmental exposure analysis."]}),"\n",(0,i.jsx)(n.p,{children:"This SOP describes the workflow for running codes to geocode patient location data and link latitude and longitude coordinates with exposome datasets. All code will be executed locally at each site. Only the exposure tables containing exposome data will be shared with the central server; no address-level data will be transmitted or stored centrally. Sites should use the most granular address information available to them or latitude/longitude coordinates."}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Demo video"})," ",(0,i.jsx)(n.a,{href:"https://drive.google.com/drive/folders/14FdY0lB3WRIiYrgCdeje6NAQI7Q_RB2w?usp=sharing",children:"Watch here"})]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"-table-of-contents",children:"\ud83d\udcd1 Table of Contents"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"#geocoding-patient-data-for-exposome-linkage",children:"Geocoding Patient Data for Exposome Linkage"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#-table-of-contents",children:"\ud83d\udcd1 Table of Contents"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#overview",children:"Overview"})}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"#input-options",children:"Input Options"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#option-1-address",children:"Option 1: Address"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#option-2-coordinates",children:"Option 2: Coordinates"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#option-3-omop-cdm",children:"Option 3: OMOP CDM"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"#UsageGuideForGeocoding",children:"Usage Guide"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#step-1-prepare-input-data",children:"Step 1: Prepare Input Data"})}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"#step-2-generate-fips-codes",children:"Step 2: Generate FIPS Codes"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#for-csv-input-option-1--2",children:"For CSV Input (Option 1 & 2)"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#for-omop-input-option-3",children:"For OMOP Input (Option 3)"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"#step-3-output-structure",children:"Step 3: Output Structure"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#csv-input-option-1--2",children:"CSV Input (Option 1 & 2)"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#omop-input-option-3",children:"OMOP Input (Option 3)"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"#step-4-gis-linkage-with-postgis-exposure-tool",children:"Step 4: GIS Linkage with PostGIS-Exposure Tool"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#prerequisites-for-gis-linkage",children:"Prerequisites for GIS Linkage"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#expected-outputs",children:"Expected Outputs"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#gis-linkage-workflow",children:"GIS Linkage Workflow"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#notes--tips",children:"Notes & Tips"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#step-5-validate--inspect-outputs",children:"Step 5: Validate & Inspect Outputs"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#step-6-optional---site-level-date-shifting",children:"Step 6: Optional - Site-level Date Shifting"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#step-7-upload--centralized-de-identification",children:"Step 7: Upload & Centralized De-identification"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"#appendix",children:"Appendix"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"#geocoding-workflow",children:"Geocoding Workflow"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#method-degauss-toolkit-docker-based",children:"Method: DeGAUSS Toolkit (Docker-based)"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#degauss-docker-commands-executed-internally",children:"DeGAUSS Docker Commands (Executed Internally)"})}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"#script-highlights",children:"Script Highlights"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#address_to_fipspy-logic",children:"Address_to_FIPS.py Logic"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#omop_to_fipspy-logic",children:"OMOP_to_FIPS.py Logic"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,i.jsxs)(n.p,{children:["This workflow uses ",(0,i.jsx)(n.strong,{children:"two separate Docker containers"})," to support end-to-end geocoding and data linkage:"]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsxs)(n.strong,{children:["Exposome Geocoder Container (",(0,i.jsx)(n.code,{children:"prismaplab/exposome-geocoder:1.0.3"}),")"]}),(0,i.jsx)(n.br,{}),"\n","Performs address or coordinate-based geocoding to generate Census Tract (FIPS 11-digit) codes using ",(0,i.jsx)(n.a,{href:"https://degauss.org",children:"DeGAUSS"})," backend tools."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsxs)(n.strong,{children:["Exposome Linkage Container (",(0,i.jsx)(n.code,{children:"ghcr.io/chorus-ai/chorus-postgis-sdoh:main"}),")"]}),(0,i.jsx)(n.br,{}),"\n","Integrates the geocoded outputs with relevant environmental and social determinant datasets to produce analysis-ready files."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Together, these containers enable:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Address and latitude/longitude-based geocoding"}),"\n",(0,i.jsx)(n.li,{children:"OMOP CDM geocoding extraction and processing"}),"\n",(0,i.jsx)(n.li,{children:"GIS linkage with PostGIS-SDoH indices (ADI, SVI, AHRQ)"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"input-options",children:"Input Options"}),"\n",(0,i.jsxs)(n.p,{children:["You need to prepare ",(0,i.jsx)(n.strong,{children:"only ONE"})," of the following data elements per encounter."]}),"\n",(0,i.jsx)(n.h3,{id:"option-1-address",children:"Option 1: Address"}),"\n",(0,i.jsxs)(n.p,{children:["Sample input files ",(0,i.jsx)(n.a,{href:"https://github.com/bihorac-LAB/Exposome/tree/main/Tools/demo/address_files/input",children:"here"})]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"Format A: Multi-Column Address"})}),"\n"]}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"street"}),(0,i.jsx)(n.th,{children:"city"}),(0,i.jsx)(n.th,{children:"state"}),(0,i.jsx)(n.th,{children:"zip"}),(0,i.jsx)(n.th,{children:"year"}),(0,i.jsx)(n.th,{children:"entity_id"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"1250 W 16th St"}),(0,i.jsx)(n.td,{children:"Jacksonville"}),(0,i.jsx)(n.td,{children:"FL"}),(0,i.jsx)(n.td,{children:"32209"}),(0,i.jsx)(n.td,{children:"2019"}),(0,i.jsx)(n.td,{children:"1"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"2001 SW 16th St"}),(0,i.jsx)(n.td,{children:"Gainesville"}),(0,i.jsx)(n.td,{children:"FL"}),(0,i.jsx)(n.td,{children:"32608"}),(0,i.jsx)(n.td,{children:"2019"}),(0,i.jsx)(n.td,{children:"2"})]})]})]}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Tip:"})," Street ",(0,i.jsx)(n.strong,{children:"and"})," ZIP are required. Missing these fields may lead to ",(0,i.jsx)(n.strong,{children:"imprecise geocoding"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"Format B: Single Column Address"})}),"\n"]}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"address"}),(0,i.jsx)(n.th,{children:"year"}),(0,i.jsx)(n.th,{children:"entity_id"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"1250 W 16th St Jacksonville FL 32209"}),(0,i.jsx)(n.td,{children:"2019"}),(0,i.jsx)(n.td,{children:"1"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"2001 SW 16th St Gainesville FL 32608"}),(0,i.jsx)(n.td,{children:"2019"}),(0,i.jsx)(n.td,{children:"2"})]})]})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h4,{id:"optional-supporting-files",children:"Optional Supporting Files"}),"\n",(0,i.jsxs)(n.p,{children:["Including the following optional files will help streamline the ",(0,i.jsx)(n.strong,{children:"end-to-end workflow"})," between geocoding and exposome linkage:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Important"}),": Do not date-shift your LOCATION/LOCATION_HISTORY files before linkage. Date shifting (if used) should occur post linkage in Step 4."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.a,{href:"https://github.com/bihorac-LAB/Exposome/blob/main/Tools/demo/address_files/input/LOCATION.csv",children:(0,i.jsx)(n.code,{children:"LOCATION.csv"})})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.a,{href:"https://github.com/bihorac-LAB/Exposome/blob/main/Tools/demo/address_files/input/LOCATION_HISTORY.csv",children:(0,i.jsx)(n.code,{children:"LOCATION_HISTORY.csv"})})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["If these files are provided during ",(0,i.jsx)(n.strong,{children:"geocoding"}),", the output will automatically include the updated latitude and longitude information required for the ",(0,i.jsx)(n.strong,{children:"postgis linkage container"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["If they are ",(0,i.jsx)(n.strong,{children:"not provided"}),", users will need to ",(0,i.jsx)(n.strong,{children:"manually update their LOCATION files"})," with the geocoded latitude/longitude before executing the commands for linkage."]}),"\n",(0,i.jsx)(n.h5,{id:"locationcsv-follows-cdm-format",children:"LOCATION.csv (Follows CDM format)"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"location_id"}),(0,i.jsx)(n.th,{children:"address_1"}),(0,i.jsx)(n.th,{children:"address_2"}),(0,i.jsx)(n.th,{children:"city"}),(0,i.jsx)(n.th,{children:"state"}),(0,i.jsx)(n.th,{children:"zip"}),(0,i.jsx)(n.th,{children:"county"}),(0,i.jsx)(n.th,{children:"location_source_value"}),(0,i.jsx)(n.th,{children:"country_concept_id"}),(0,i.jsx)(n.th,{children:"country_source_value"}),(0,i.jsx)(n.th,{children:"latitude"}),(0,i.jsx)(n.th,{children:"longitude"})]})}),(0,i.jsx)(n.tbody,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"1"}),(0,i.jsx)(n.td,{children:"1248 N Blackstone Ave"}),(0,i.jsx)(n.td,{}),(0,i.jsx)(n.td,{children:"FRESNO"}),(0,i.jsx)(n.td,{children:"CA"}),(0,i.jsx)(n.td,{children:"93703"}),(0,i.jsx)(n.td,{}),(0,i.jsx)(n.td,{children:"UNITED STATES OF AMERICA"}),(0,i.jsx)(n.td,{}),(0,i.jsx)(n.td,{children:"UNITED STATES OF AMERICA"}),(0,i.jsx)(n.td,{children:"36.75891146"}),(0,i.jsx)(n.td,{children:"-119.7902719"})]})})]}),"\n",(0,i.jsx)(n.h5,{id:"location_historycsv-follows-cdm-format",children:"LOCATION_HISTORY.csv (Follows CDM format)"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"location_id"}),(0,i.jsx)(n.th,{children:"relationship_type_concept_id"}),(0,i.jsx)(n.th,{children:"domain_id"}),(0,i.jsx)(n.th,{children:"entity_id"}),(0,i.jsx)(n.th,{children:"start_date"}),(0,i.jsx)(n.th,{children:"end_date"})]})}),(0,i.jsx)(n.tbody,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"1"}),(0,i.jsx)(n.td,{children:"32848"}),(0,i.jsx)(n.td,{children:"1147314"}),(0,i.jsx)(n.td,{children:"3763"}),(0,i.jsx)(n.td,{children:"1998-01-01"}),(0,i.jsx)(n.td,{children:"2020-01-01"})]})})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"option-2-coordinates",children:"Option 2: Coordinates"}),"\n",(0,i.jsxs)(n.p,{children:["Sample input files ",(0,i.jsx)(n.a,{href:"https://github.com/bihorac-LAB/Exposome/tree/main/Tools/demo/latlong_files/input",children:"here"})]}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"latitude"}),(0,i.jsx)(n.th,{children:"longitude"}),(0,i.jsx)(n.th,{children:"entity_id"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"30.353463"}),(0,i.jsx)(n.td,{children:"-81.6749"}),(0,i.jsx)(n.td,{children:"1"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"29.634219"}),(0,i.jsx)(n.td,{children:"-82.3433"}),(0,i.jsx)(n.td,{children:"2"})]})]})]}),"\n",(0,i.jsxs)(n.p,{children:["As with address-based input, including ",(0,i.jsx)(n.code,{children:"LOCATION.csv"})," and ",(0,i.jsx)(n.code,{children:"LOCATION_HISTORY.csv"})," enables seamless downstream processing with the linkage container."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"option-3-omop-cdm",children:"Option 3: OMOP CDM"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Table"}),(0,i.jsx)(n.th,{children:"Required Columns"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"person"}),(0,i.jsx)(n.td,{children:"person_id"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"visit_occurrence"}),(0,i.jsx)(n.td,{children:"visit_occurrence_id, visit_start_date, visit_end_date, person_id"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"location"}),(0,i.jsx)(n.td,{children:"location_id, address_1, address_2, city, state, zip, location_source_value, country_concept_id, country_source_value, latitude, longitude"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"location_history"}),(0,i.jsx)(n.td,{children:"location_id, relationship_type_concept_id, domain_id, entity_id, start_date, end_date"})]})]})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"usage-guide",children:"Usage Guide"}),"\n",(0,i.jsx)(n.h3,{id:"step-1-prepare-input-data",children:"Step 1: Prepare Input Data"}),"\n",(0,i.jsxs)(n.p,{children:["Prepare ",(0,i.jsx)(n.strong,{children:"only ONE"})," of the data elements as indicated under the ",(0,i.jsx)(n.a,{href:"#input-options",children:"Input Options"})," per encounter.",(0,i.jsx)(n.br,{}),"\n","For ",(0,i.jsx)(n.strong,{children:"Option 1 (Address)"})," or ",(0,i.jsx)(n.strong,{children:"Option 2 (Coordinates)"}),", your data must be in a ",(0,i.jsx)(n.strong,{children:"CSV file"})," format."]}),"\n",(0,i.jsx)(n.h4,{id:"folder-structure",children:"Folder Structure"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Place the CSV file(s) in a dedicated folder","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\ud83d\udcc2 ",(0,i.jsx)(n.code,{children:"input_address/"}),"  ",(0,i.jsx)(n.em,{children:"(for address-based data)"})]}),"\n",(0,i.jsxs)(n.li,{children:["\ud83d\udcc2 ",(0,i.jsx)(n.code,{children:"input_coordinates/"}),"  ",(0,i.jsx)(n.em,{children:"(for coordinate-based data)"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Optionally, include:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"LOCATION.csv"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"LOCATION_HISTORY.csv"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:["\u26a0\ufe0f Only ",(0,i.jsx)(n.code,{children:".csv"})," files are supported. Convert ",(0,i.jsx)(n.code,{children:".xlsx"})," or other formats before running the tool."]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"step-2-generate-fips-codes",children:"Step 2: Generate FIPS Codes"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Container:"})," ",(0,i.jsx)(n.code,{children:"prismaplab/exposome-geocoder:1.0.3"}),(0,i.jsx)(n.br,{}),"\n","Ensure ",(0,i.jsx)(n.strong,{children:"Docker Desktop"})," is running."]}),"\n",(0,i.jsx)(n.p,{children:"This step uses the Exposome Geocoder container to:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Convert addresses or coordinates into latitude/longitude"}),"\n",(0,i.jsx)(n.li,{children:"Assign 11-digit Census Tract (FIPS) codes"}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"for-csv-input-option-1--2",children:"For CSV Input (Option 1 & 2)"}),"\n",(0,i.jsx)(n.h5,{id:"for-macos--linux--ubuntu",children:"For macOS / Linux / Ubuntu"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'docker run -it --rm \\\n  -v "$(pwd)":/workspace \\\n  -v /var/run/docker.sock:/var/run/docker.sock \\\n  -e HOST_PWD="$(pwd)" \\\n  -w /workspace \\\n  prismaplab/exposome-geocoder:1.0.3 \\\n  /app/code/Address_to_FIPS.py -i <input_folder_path>\n'})}),"\n",(0,i.jsx)(n.h5,{id:"for-windows",children:"For Windows"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Open Command Prompt or powershell"}),"\n",(0,i.jsxs)(n.li,{children:["Run command ",(0,i.jsx)(n.code,{children:"wsl"})]}),"\n",(0,i.jsx)(n.li,{children:"Execute the same command as above inside your WSL terminal."}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Example:"}),"\n",(0,i.jsxs)(n.p,{children:["If your file is named patients_address.csv inside \ud83d\udcc2",(0,i.jsx)(n.code,{children:"input_address/"}),", run:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'docker run -it --rm   -v "$(pwd)":/workspace   -v /var/run/docker.sock:/var/run/docker.sock   -e HOST_PWD="$(pwd)"   -w /workspace   prismaplab/exposome-geocoder:1.0.3   /app/code/Address_to_FIPS.py -i input_address\n'})}),"\n",(0,i.jsx)(n.h4,{id:"for-omop-input-option-3",children:"For OMOP Input (Option 3)"}),"\n",(0,i.jsx)(n.p,{children:"To extract and geocode directly from an OMOP database:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'docker run -it --rm \\\n  -v /var/run/docker.sock:/var/run/docker.sock \\\n  -v "$(pwd)":/workspace \\\n  -e HOST_PWD="$(pwd)" \\\n  -w /workspace \\\n  prismaplab/exposome-geocoder:1.0.3 \\\n  /app/code/OMOP_to_FIPS.py \\\n    --user <your_username> \\\n    --password <your_password> \\\n    --server <server_address> \\\n    --port <port_number> \\\n    --database <database_name>\n'})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"step-3-output-structure",children:"Step 3: Output Structure"}),"\n",(0,i.jsxs)(n.p,{children:["After running the geocoder container (for Option 1, 2, or 3), the tool generates output files in the ",(0,i.jsx)(n.code,{children:"output/"})," folder."]}),"\n",(0,i.jsx)(n.h4,{id:"csv-input-option-1--2",children:"CSV Input (Option 1 & 2)"}),"\n",(0,i.jsxs)(n.p,{children:["Sample outputs ",(0,i.jsx)(n.a,{href:"https://github.com/bihorac-LAB/Exposome/tree/main/Tools/demo/address_files/output",children:"demo/address_files/output"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Files Generated"}),"\nEach input file produces:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"<filename>_with_coordinates.csv"})," \u2014 input + latitude/longitude"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"<filename>_with_fips.csv"})," \u2014 input + FIPS codes"]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"output-folder-example",children:(0,i.jsx)(n.strong,{children:"Output Folder Example"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"output/\n\u251c\u2500\u2500 coordinates_from_address_<timestamp>.zip\n\u251c\u2500\u2500 geocoded_fips_codes_<timestamp>.zip\n"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"<timestamp>"})," indicates when the script was executed (e.g., 20250624_150230)."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["If ",(0,i.jsx)(n.code,{children:"LOCATION.csv"})," and ",(0,i.jsx)(n.code,{children:"LOCATION_HISTORY.csv"})," were included, they are copied to ",(0,i.jsx)(n.code,{children:"output/"})," but not zipped."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Zipped Output Columns Description"})}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Column"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"Latitude"})}),(0,i.jsx)(n.td,{children:"Latitude returned from the geocoder"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"Longitude"})}),(0,i.jsx)(n.td,{children:"Longitude returned from the geocoder"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"geocode_result"})}),(0,i.jsxs)(n.td,{children:["Outcome of geocoding \u2014 ",(0,i.jsx)(n.code,{children:"geocoded"})," for successful matches, ",(0,i.jsx)(n.code,{children:"Imprecise Geocode"})," if not precise"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"reason"})}),(0,i.jsxs)(n.td,{children:["Failure reason if applicable (see ",(0,i.jsx)(n.a,{href:"#reason-column-values",children:"Reason Column Values"}),")"]})]})]})]}),"\n",(0,i.jsx)(n.h5,{id:"reason-column-values",children:"Reason Column Values"}),"\n",(0,i.jsx)(n.p,{children:"Used when geocoding fails or is imprecise. Possible values include:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Hospital address given"})," \u2013 Detected from known hardcoded hospital addresses."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Street missing"})," \u2013 No street info provided."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Blank/Incomplete address"})," \u2013 Address is empty or has missing components."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Zip missing"})," \u2013 ZIP code not provided."]}),"\n"]}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:["\ud83d\udca1 ",(0,i.jsx)(n.strong,{children:"Tip:"})," You can expand hospital detection by adding known addresses to ",(0,i.jsx)(n.code,{children:"HOSPITAL_ADDRESSES"})," in ",(0,i.jsx)(n.a,{href:"https://github.com/bihorac-LAB/Exposome/blob/main/Tools/code/Address_to_FIPS.py",children:(0,i.jsx)(n.code,{children:"Address_to_FIPS.py"})}),"."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsxs)(n.strong,{children:["Formatting Note for ",(0,i.jsx)(n.code,{children:"HOSPITAL_ADDRESSES"}),":"]})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Single-line string"}),"\n",(0,i.jsx)(n.li,{children:"Lowercase letters and numbers only"}),"\n",(0,i.jsx)(n.li,{children:"No commas or special characters"}),"\n",(0,i.jsx)(n.li,{children:"Fields separated by single spaces"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h4,{id:"omop-input-option-3",children:"OMOP Input (Option 3)"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Sample outputs:"})," ",(0,i.jsx)(n.a,{href:"https://github.com/bihorac-LAB/Exposome/tree/main/Tools/demo/OMOP/output",children:"demo/OMOP/output"})]}),"\n",(0,i.jsx)(n.h4,{id:"folder-structure-1",children:(0,i.jsx)(n.strong,{children:"Folder Structure"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"OMOP_data/\n\u251c\u2500\u2500 valid_address/               # Records with address, no lat/lon\n\u251c\u2500\u2500 invalid_lat_lon_address/     # Records missing both address and lat/lon\n\u251c\u2500\u2500 valid_lat_long/              # Records with lat/lon\n\nOMOP_FIPS_result/\n\u251c\u2500\u2500 address/\n\u2502   \u251c\u2500\u2500 address_with_coordinates.zip   # CSVs with lat/lon from address\n\u2502   \u2514\u2500\u2500 address_with_fips.zip          # CSVs with FIPS codes\n\u251c\u2500\u2500 latlong/\n\u2502   \u2514\u2500\u2500 latlong_with_fips.zip          # CSVs with FIPS from coordinates\n\u251c\u2500\u2500 invalid/                           # Usually empty; no usable location data\n\nLOCATION.csv\nLOCATION_HISTORY.csv\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"step-4-gis-linkage-with-postgis-exposure-tool",children:"Step 4: GIS Linkage with PostGIS-Exposure Tool"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Purpose:"}),(0,i.jsx)(n.br,{}),"\n","Spatially joins the lat/lon (and FIPS) from geocoding with geospatial indices (ADI, SVI, AHRQ) and produces ",(0,i.jsx)(n.code,{children:"EXTERNAL_EXPOSURE.csv"}),"."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h4,{id:"prerequisites-for-gis-linkage",children:"Prerequisites for GIS Linkage"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Docker installed."}),"\n",(0,i.jsxs)(n.li,{children:["Clone ",(0,i.jsx)(n.a,{href:"https://github.com/chorus-ai/chorus-container-apps/tree/main/postgis-exposure",children:"postgis-exposure repository"})]}),"\n",(0,i.jsxs)(n.li,{children:["Update ",(0,i.jsx)(n.code,{children:"LOCATION"}),", ",(0,i.jsx)(n.code,{children:"LOCATION_HISTORY"})," files to include the geocoded lat/lon from Step 2. Not needed if you included these during the geocoding step"]}),"\n",(0,i.jsxs)(n.li,{children:["Ensure ",(0,i.jsx)(n.code,{children:"DATA_SRC_SIMPLE.csv"})," and ",(0,i.jsx)(n.code,{children:"VRBL_SRC_SIMPLE.csv"})," files are available (centrally managed; no edits required)."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Important:"})," Do ",(0,i.jsx)(n.strong,{children:"not"})," date-shift your ",(0,i.jsx)(n.code,{children:"LOCATION"}),"/",(0,i.jsx)(n.code,{children:"LOCATION_HISTORY"})," files before linkage. Date shifting (if used) should occur following this step."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Sample ",(0,i.jsx)(n.code,{children:"DATA_SRC_SIMPLE.csv"})," and ",(0,i.jsx)(n.code,{children:"VRBL_SRC_SIMPLE.csv"}),": ",(0,i.jsx)(n.a,{href:"https://github.com/chorus-ai/chorus-container-apps/tree/main/postgis-exposure/csv",children:"here"})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h4,{id:"expected-outputs",children:"Expected Outputs"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"EXTERNAL_EXPOSURE.csv"})," containing linked indices (ADI, SVI, AHRQ metrics)."]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h4,{id:"gis-linkage-workflow",children:"GIS Linkage Workflow"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Start Postgres/PostGIS container"})," following the instructions in the ",(0,i.jsx)(n.a,{href:"https://github.com/chorus-ai/chorus-container-apps/tree/main/postgis-exposure",children:"postgis-exposure repository"}),".\nContainer sequence: start/load database \u2192 ingest location tables \u2192 run the produce script.\n",(0,i.jsx)(n.strong,{children:"First Docker command (prepares the database):"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker run --rm --name postgis-chorus \\\n  --env POSTGRES_PASSWORD=dummy \\\n  --env VARIABLES=134,135,136 \\\n  --env DATA_SOURCES=1234,5150,9999 \\\n  -v $(pwd)/test/source:/source \\\n  -d ghcr.io/chorus-ai/chorus-postgis-sdoh:main\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Replace ",(0,i.jsx)(n.code,{children:"VARIABLES"})," with the comma-separated list of variable IDs you need from ",(0,i.jsx)(n.code,{children:"VRBL_SRC_SIMPLE.csv"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Replace ",(0,i.jsx)(n.code,{children:"DATA_SOURCES"})," with the relevant data source IDs (from ",(0,i.jsx)(n.code,{children:"DATA_SRC_SIMPLE.csv"}),")."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"** Generate the external exposure file:**"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker exec postgis-chorus /app/produce_external_exposure.sh\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Output:"})," ",(0,i.jsx)(n.code,{children:"EXTERNAL_EXPOSURE.csv"})," will appear in your mounted directory (e.g., ",(0,i.jsx)(n.code,{children:"./test/source"}),")."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"notes--tips",children:"Notes & Tips"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Run these commands in Terminal (Mac) or WSL/PowerShell/Command Prompt on Windows; WSL is more robust for Docker on Windows."}),"\n",(0,i.jsxs)(n.li,{children:["If your site needs more variables, expand ",(0,i.jsx)(n.code,{children:"VARIABLES"})," accordingly."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Important"}),": The container may only run successfully once. To rerun, you may need to delete the container and image, then pull the image again."]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"step-5-validate--inspect-outputs",children:"Step 5: Validate & Inspect Outputs"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Open ",(0,i.jsx)(n.code,{children:"EXTERNAL_EXPOSURE.csv"}),". Confirm:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Patient ID, lat, lon, FIPS"}),"\n",(0,i.jsx)(n.li,{children:"ADI, SVI, AHRQ, and VRBL-coded fields"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:"Spot-check a few records for accuracy."}),"\n",(0,i.jsxs)(n.li,{children:["If errors:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Ensure ",(0,i.jsx)(n.code,{children:"LOCATION"})," has valid lat/lon/FIPS"]}),"\n",(0,i.jsxs)(n.li,{children:["Confirm ",(0,i.jsx)(n.code,{children:"VARIABLES"})," and ",(0,i.jsx)(n.code,{children:"DATA_SOURCES"})," are correct"]}),"\n",(0,i.jsx)(n.li,{children:"Check mount paths"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"step-6-optional---site-level-date-shifting",children:"Step 6: Optional - Site-level Date Shifting"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Purpose:"})," Anonymize temporal data while preserving relative timelines."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Guidelines:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Apply date shifts locally before upload \u2014 do not date-shift prior to GIS linkage."}),"\n",(0,i.jsxs)(n.li,{children:["Input: ",(0,i.jsx)(n.code,{children:"EXTERNAL_EXPOSURE.csv"})," (from Step 4)"]}),"\n",(0,i.jsxs)(n.li,{children:["Output: ",(0,i.jsx)(n.code,{children:"EXTERNAL_EXPOSURE_date_shifted.csv"})]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["See ",(0,i.jsx)(n.a,{href:"https://github.com/chorus-ai/Chorus_SOP/blob/main/sop-website/docs/Privacy/Date-Shifting.mdx",children:"Date Shifting SOP for More Details"}),"."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"step-7-upload--centralized-de-identification",children:"Step 7: Upload & Centralized De-identification"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Upload the (optionally date-shifted) ",(0,i.jsx)(n.code,{children:"EXTERNAL_EXPOSURE.csv"})," to the central repository."]}),"\n",(0,i.jsx)(n.li,{children:"The central team will apply further de-identification."}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"references--sample-files",children:"References & sample files"}),"\n",(0,i.jsx)(n.h4,{id:"geocoding",children:"Geocoding"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Sample files: ",(0,i.jsx)(n.a,{href:"https://github.com/bihorac-LAB/Exposome/tree/main/Tools/demo",children:"Geocoding Demo Files"})]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"gis-linkage",children:"GIS Linkage"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Sample files: ",(0,i.jsx)(n.a,{href:"https://github.com/chorus-ai/chorus-container-apps/tree/main/postgis-exposure/csv",children:"PostGIS Exposure CSVs"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Site-specific:"})," ",(0,i.jsx)(n.code,{children:"LOCATION"}),", ",(0,i.jsx)(n.code,{children:"LOCATION_HISTORY"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Centrally managed:"})," ",(0,i.jsx)(n.code,{children:"DATA_SRC_SIMPLE"}),", ",(0,i.jsx)(n.code,{children:"VRBL_SRC_SIMPLE"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"related-office-hours",children:"Related Office Hours"}),"\n",(0,i.jsx)(n.p,{children:"The following office hour sessions provide additional context and demonstrations related to this SOP:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"[08-07-25] Integration of GIS and SDoH data with OMOP"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"https://drive.google.com/file/d/1MHx7YWlWIVC2Dggjzw2uczT3MKyppWZ5/view?usp=share_link",children:"Video Recording"})," | ",(0,i.jsx)(n.a,{href:"https://docs.google.com/document/d/1v0C3COo1O-KOKpd7haVm5GGmD5gbVR0I/edit?usp=sharing&ouid=104468275537210259794&rtpof=true&sd=true",children:"Transcript"})]}),"\n",(0,i.jsx)(n.li,{children:"Comprehensive session on integrating GIS and social determinants of health data"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"[09-18-25] Processing OMOP location_history table into external_exposure table"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"https://drive.google.com/file/d/1SWovm3vnf0PVbTC_qS6n3nBuf1dI169L/view?usp=share_link",children:"Video Recording"})," | ",(0,i.jsx)(n.a,{href:"https://docs.google.com/document/d/1VII2X_NQhM69ZzUDwB6m4hsqDk6E1VCx/edit?usp=share_link&ouid=104468275537210259794&rtpof=true&sd=true",children:"Transcript"})]}),"\n",(0,i.jsx)(n.li,{children:"Technical implementation of location data processing for external exposures"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"[09-25-25] End-to-end demo for capturing GIS data with OMOP"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"https://drive.google.com/file/d/118fGVQS0ES0SV4Yu6pxLc4SB0Z08Mq9I/view?usp=share_link",children:"Video Recording"})," | ",(0,i.jsx)(n.a,{href:"https://docs.google.com/document/d/1-rPcdQp-7TcEF9-Fgwqi12508Mx2seT9/edit?usp=share_link&ouid=104468275537210259794&rtpof=true&sd=true",children:"Transcript"})]}),"\n",(0,i.jsx)(n.li,{children:"Complete workflow demonstration for GIS data capture and processing"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"[10-16-2025] End-to-end demo for capturing GIS data with OMOP or address/latlong"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"https://drive.google.com/file/d/1L5OdVWa0AsuLKy-o0Uub8JNb1Wojw7ZO/view?usp=drive_link",children:"Video Recording"})," | ",(0,i.jsx)(n.a,{href:"https://drive.google.com/file/d/1-P6edkHBfiAJKSG7ZKlkIj5Ej-u2EZ3G/view?usp=sharing",children:"Transcript"})]}),"\n",(0,i.jsx)(n.li,{children:"Complete workflow demonstration for GIS data capture and processing based on updated documentation"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"appendix",children:"Appendix"}),"\n",(0,i.jsx)(n.h3,{id:"geocoding-workflow",children:"Geocoding Workflow"}),"\n",(0,i.jsxs)(n.p,{children:["This guide outlines the scripts, workflows, and Docker-based DeGAUSS toolkit used for generating Census Tract (FIPS) information from patient data.\nTo convert patient location data into Census Tract identifiers (",(0,i.jsx)(n.strong,{children:"FIPS11"}),"), we use a two-step geocoding process powered by ",(0,i.jsx)(n.a,{href:"https://degauss.org",children:"DeGAUSS"}),", executed locally via Docker containers."]}),"\n",(0,i.jsx)(n.h4,{id:"method-degauss-toolkit-docker-based",children:"Method: DeGAUSS Toolkit (Docker-based)"}),"\n",(0,i.jsx)(n.p,{children:"DeGAUSS consists of two Docker containers:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Geocoder (3.3.0)"})," \u2014 Converts address to latitude/longitude"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Census Block Group (0.6.0)"})," \u2014 Converts latitude/longitude to Census Tract FIPS codes"]}),"\n"]}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Step"}),(0,i.jsx)(n.th,{children:"Purpose"}),(0,i.jsx)(n.th,{children:"Docker Image"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"1"}),(0,i.jsx)(n.td,{children:"Address \u2192 Coordinates"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"ghcr.io/degauss-org/geocoder:3.3.0"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"2"}),(0,i.jsx)(n.td,{children:"Coordinates \u2192 FIPS"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"ghcr.io/degauss-org/census_block_group:0.6.0"})})]})]})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h4,{id:"degauss-docker-commands-executed-internally",children:"DeGAUSS Docker Commands (Executed Internally)"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# Step 1: Get Coordinates from Address\ndocker run --rm -v "ABS_OUTPUT_FOLDER:/tmp" \\\n  ghcr.io/degauss-org/geocoder:3.3.0 \\\n  /tmp/<your_preprocessed_input.csv> <threshold>\n\n# Step 2: Get FIPS from Coordinates\ndocker run --rm -v "ABS_OUTPUT_FOLDER:/tmp" \\\n  ghcr.io/degauss-org/census_block_group:0.6.0 \\\n  /tmp/<your_coordinate_output.csv> <year>\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Replace values:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"ABS_OUTPUT_FOLDER"})," \u2192 absolute path to your output directory"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"<threshold>"})," \u2192 numeric value (e.g., ",(0,i.jsx)(n.code,{children:"0.7"}),")"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"<year>"})," \u2192 either ",(0,i.jsx)(n.code,{children:"2010"})," or ",(0,i.jsx)(n.code,{children:"2020"})]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h4,{id:"script-highlights",children:"Script Highlights"}),"\n",(0,i.jsx)(n.h5,{id:"address_to_fipspy-logic",children:"Address_to_FIPS.py Logic"}),"\n",(0,i.jsxs)(n.p,{children:["This ",(0,i.jsx)(n.a,{href:"https://github.com/bihorac-LAB/Exposome/blob/main/Tools/code/Address_to_FIPS.py",children:"script"})," handles CSV-based input:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Reads CSV files"}),"\n",(0,i.jsx)(n.li,{children:"Normalizes address or uses lat/lon"}),"\n",(0,i.jsxs)(n.li,{children:["Runs DeGAUSS Docker container to generate:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Latitude/Longitude (via ",(0,i.jsx)(n.code,{children:"ghcr.io/degauss-org/geocoder"}),")"]}),"\n",(0,i.jsxs)(n.li,{children:["FIPS codes(via ",(0,i.jsx)(n.code,{children:"ghcr.io/degauss-org/census_block_group"}),")"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:"Packages outputs into ZIP"}),"\n"]}),"\n",(0,i.jsx)(n.h5,{id:"omop_to_fipspy-logic",children:"OMOP_to_FIPS.py Logic"}),"\n",(0,i.jsxs)(n.p,{children:["This ",(0,i.jsx)(n.a,{href:"https://github.com/bihorac-LAB/Exposome/blob/main/Tools/code/OMOP_to_FIPS.py",children:"script"})," integrates directly with ",(0,i.jsx)(n.strong,{children:"OMOP CDM"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Extracts OMOP CDM data"}),"\n",(0,i.jsx)(n.li,{children:"Categorizes into valid/invalid address or coordinates"}),"\n",(0,i.jsx)(n.li,{children:"Executes FIPS generation (same as CSV workflow)"}),"\n",(0,i.jsx)(n.li,{children:"Packages outputs into ZIP"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{})]})}function a(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>t});var i=s(6540);const r={},d=i.createContext(r);function o(e){const n=i.useContext(d);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),i.createElement(d.Provider,{value:n},e.children)}}}]);